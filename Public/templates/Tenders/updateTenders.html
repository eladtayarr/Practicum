<!DOCTYPE html>
<html class="no-js" lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Trisi Sinai || Practicum</title>
<link rel="shortcut icon" href="../../images/favicon.ico" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="shortcut icon" href="../../images/favicon.ico">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../../src/css/animate.css">
<link rel="stylesheet" href="../../src/css/icomoon.css">
<link rel="stylesheet" href="../../src/css/bootstrap.css">
<link rel="stylesheet" href="../../src/css/superfish.css">
<link rel="stylesheet" href="../../src/css/flexslider.css">
<link rel="stylesheet" href="../../src/css/magnific-popup.css">
<link rel="stylesheet" href="../../src/css/bootstrap-datepicker.css">
<link rel="stylesheet" href="../../src/css/cs-select.css">
<link rel="stylesheet" href="../../src/css/cs-skin-border.css">
<link rel="stylesheet" href="../../src/css/style.css">
<script src="../../src/js/modernizr-2.6.2.min.js"></script>

<style>
    body {
        font-family: 'Open Sans', sans-serif;
        color: #333;
        background-color: #f8f8f8;
    }
    .form-group {
        max-width: 500px;
        margin: 0 auto;
        padding: 20px;
    }
    #sub {
        display: block;
        margin: 0 auto;
        padding: 15px;
        width: fit-content; 
    }
    .button-container {
        text-align: center;
        margin-top: 20px;
    }
    .property-button {
        margin: 0 10px;
        padding: 10px 20px;
        background-color: #d1869b;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    .property-button:hover {
        background-color: rgb(38, 152, 191);
    }
    #footer #fh5co-header-subscribe button {
    position: absolute;
    top: 20px;
    right: -20px;
    border-top-left-radius: 0px !important;
    border-bottom-left-radius: 0px !important;
    background: #de6277;
    border: none;

    .form-group .select {
        width: 100%;        /* Makes the select box take full width of its parent container */
        padding: 12px 20px; /* Adds substantial padding for easier interaction */
        font-size: 18px;    /* Increases the font size for better readability */
        border: 2px solid #ccc; /* Subtle border styling */
        border-radius: 5px; /* Rounds the corners */
        background-color: white; /* Ensures the background is white */
        box-shadow: 0px 2px 5px rgba(0,0,0,0.1); /* Optional: adds a shadow for a slight depth effect */
        cursor: pointer;    /* Changes cursor to indicate it’s clickable */
    }
    
    .form-group .select:focus {
        border-color: #0056b3; /* Dark blue border on focus */
        outline: none; /* Removes the default focus outline */
    }
}


</style>

</head>
<body>
<div id="fh5co-wrapper">
<div id="fh5co-page">

    <header id="fh5co-header-section" class="sticky-banner">
        <div class="container">
            <div class="nav-header">
                <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle dark"><i></i></a>
                <h1 id="fh5co-logo"><a href="../../templates/Manager/ManagerHome.html"><i class="icon-home"></i> תריסי סיני <span> בע״מ.</span></a></h1>
                <nav id="fh5co-menu-wrap" role="navigation">
                    <ul class="sf-menu" id="fh5co-primary-menu">
                        <li class="active"><a href="../../templates/Manager/ManagerHome.html">דף הבית</a></li>
                        <li>
                            <a>מוצרים</a>
                            <ul class="fh5co-sub-menu">
                                <li><a href="../../templates/Products/allProducts-Manager.html">צפייה בכל המוצרים</a></li>
                                <li><a href="../../templates/Products/addNewProduct-Manager.html">הוספת מוצר חדש</a></li>
                                <li><a href="../../templates/Products/updateProducts-Manager.html">עכדון מוצר</a></li>
                            </ul>
                        </li>
                        <!-- New "Deals" tab containing "Deal" and "Deals View" links -->
                        <li>
                            <a>מכירות</a>
                            <ul class="fh5co-sub-menu">
                                <li><a href="/../../templates/Manager/DealsV-Manager.html">צפייה בכל המכירות</a></li>
                                <li><a href="../../templates/Manager/addD-Manager.html">הוספת מכירה חדשה</a></li>
                            </ul>
                        </li>

                        <li>
                            <a>ניהול</a>
                            <ul class="fh5co-sub-menu">
                                <li><a href="../../templates/Manager/addNewCustomer-Manager.html">הוסף לקוח חדש</a></li>
                                <li><a href="../../templates/Manager/Add_ViewUsers-Manager.html">הוסף משתמש חדש</a></li>
                                <li><a href="../../templates/Installer/Add-Installations.html">הוסף מתקין חדש</a></li>
                            </ul>
                        </li>
                        <li>
                            <a>התקנות</a>
                              <ul class="fh5co-sub-menu">
                                  <li><a href="../../templates/Installer/View-Installations.html">צפייה בכל ההתקנות</a></li>
                                  <li><a href="../../templates/Installer/Add-Installations.html">הוספת התקנה חדשה</a></li>
                              </ul>
                        </li>
                        <li>
                            <a>דוחות</a>
                            <ul class="fh5co-sub-menu">
                                <li><a href="../../templates/Reports/Reports-Customer.html">דוח לקוחות</a></li>
                                <li><a href="../../templates/Reports/Reports-Deal.html">דוח מבצעים</a></li>
                                <li><a href="../../templates/Reports/Reports-Products.html">דוח מוצרים</a></li>
                            </ul>
                        </li>
                        <li>
                            <a>מכרזים</a>
                            <ul class="fh5co-sub-menu">
                              <li><a href="../../templates/Tenders/allTenders.html">צפייה במכרזים</a></li>
                              <li><a href="../../templates/Tenders/addTenders.html">הוספת מכרז חדש</a></li>
                              <li><a href="../../templates/Tenders/updateTenders.html">עדכון/מחיקת מכרז</a></li>
                            </ul>
                        </li>
                        <li><a href="../../templates/Dashbords/Manager/Dashbord-Manager.html">לוח בקרה</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <aside id="fh5co-hero" class="js-fullheight">
        <div class="flexslider js-fullheight">
            <ul class="slides">
               <li style="background-image: url(../../src/images/AddProducts.jpg);">
                   <div class="overlay"></div>
                   <div class="container-fluid">
                       <div class="row">
                           <div class="col-md-8 col-md-offset-2 text-center js-fullheight slider-text">
                               <div class="slider-text-inner">
                                   <h2 class="heading-title">עדכון מכרז</h2>
                               </div>
                           </div>
                       </div>
                   </div>
               </li>
             </ul>
         </div>
    </aside>

    <div class="container">
        <div class="row">
            <div class="col-md-8 col-md-offset-2 text-center heading-section animate-box">
                <h3>עדכון מכרזים</h3>
                <p>כאן תוכל לעדכן או למחוק מכרזים קיימים.</p>
            </div>
        </div>
        <table id="tendersTable" class="table table-bordered">
            <thead>
                <tr>
                    <th>קוד מכרז</th>
                    <th>קוד לקוח</th>
                    <th>שם לקוח</th>
                    <th>תאריך הזנת המכרז</th>
                    <th>קוד מוצר</th>
                    <th>עלות ליחידת מוצר</th>
                    <th>הסברים</th>
                    <th>עריכה</th>
                    <th>מחיקה</th>
                </tr>
            </thead>
            <tbody>
                <!-- שורות יתווספו דינמית -->
            </tbody>
        </table>
    </div>

    <footer>
        <div id="footer">
          <div class="container">
            <div class="row row-bottom-padded-md">
              <!-- זכויות יוצרים -->
              <p style="font-size:20px;">
                &copy; <span id="year"></span>כל הזכויות שמורות לתריסי סיני בע״מ.<br/>
                <p style="font-size:18px;">באתר נבנה ומנוהל על ידי:<br> 
                  אלעד טייר | ליאור סיני | אור מנחם | תאיר מלכה</p>
                <a style="color: #0077b6; text-decoration: none; font-weight:500 ">תקנון תנאי השימוש</a><a style="color: white">||</a><a style="color: #0077b6; text-decoration: none; font-weight:500">מדיניות פרטיות</a>
            </p>
              
            </div>
            
          </div>
        </div>
    </footer>
</div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const tableBody = document.querySelector("#tendersTable tbody");

        // שליפת כל המכרזים
        fetch("/Tenders")
            .then(response => response.json())
            .then(tenders => {
                tableBody.innerHTML = ""; // ניקוי טבלה קיימת
                tenders.forEach(tender => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${tender.tenderID || "N/A"}</td>
                        <td>${tender.customerID || "N/A"}</td>
                        <td>${tender.customerName || "N/A"}</td>
                        <td>${tender.tenderDate || "N/A"}</td>
                        <td>${tender.productID || "N/A"}</td>
                        <td>${tender.productPrice || "N/A"}₪</td>
                        <td>${tender.discription || "N/A"}</td>
                        <td><button class="btn btn-primary btn-sm" onclick="editTender('${tender._id}')">ערוך</button></td>
                        <td><button class="btn btn-danger btn-sm" onclick="deleteTender('${tender._id}')">מחק</button></td>
                    `;
                    tableBody.appendChild(row);
                });
            })
            .catch(error => console.error("Error fetching tenders:", error));
    });

    // פונקציה למחיקת מכרז
    function deleteTender(tenderId) {
        if (confirm("האם אתה בטוח שברצונך למחוק את המכרז?")) {
            fetch(`/Tenders/${tenderId}`, { method: "DELETE" })
                .then(response => {
                    if (response.ok) {
                        alert("המכרז נמחק בהצלחה!");
                        location.reload(); // רענון הדף
                    } else {
                        alert("שגיאה במחיקת המכרז.");
                    }
                })
                .catch(error => console.error("Error deleting tender:", error));
        }
    }

    // פונקציה לעריכת מכרז
    function editTender(tenderId, currentProductID, currentPrice, currentDescription) {
        const newPrice = prompt("הכנס מחיר חדש למוצר:", currentPrice);
        const newDescription = prompt("הכנס הסבר חדש:", currentDescription);

        if (newPrice && newDescription) {
            const updatedData = {
                productPrice: newPrice,
                discription: newDescription,
                tenderDate: new Date().toISOString().split("T")[0] // תאריך עדכני
            };

            fetch(`/Tenders/${tenderId}`, {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(updatedData)
            })
                .then(response => {
                    if (response.ok) {
                        alert("המכרז עודכן בהצלחה!");
                        location.reload(); // רענון הדף
                    } else {
                        alert("שגיאה בעדכון המכרז.");
                    }
                })
                .catch(error => console.error("Error updating tender:", error));
        }
    }
</script>


<script src="../../src/js/jquery.min.js"></script>
<script src="../../src/js/jquery.easing.1.3.js"></script>
<script src="../../src/js/bootstrap.min.js"></script>
<script src="../../src/js/jquery.waypoints.min.js"></script>
<script src="../../src/js/sticky.js"></script>
<script src="../../src/js/hoverIntent.js"></script>
<script src="../../src/js/superfish.js"></script>
<script src="../../src/js/jquery.flexslider-min.js"></script>
<script src="../../src/js/bootstrap-datepicker.min.js"></script>
<script src="../../src/js/classie.js"></script>
<script src="../../src/js/selectFx.js"></script>
<script src="../../src/js/main.js"></script>

</body>
</html>
